!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.IngestAPI=t():e.IngestAPI=t()}(this,function(){return function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={exports:{},id:o,loaded:!1};return e[o].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){function o(e){e&&e.token&&this.setToken(e.token)}var r=n(2),i=n(3),s={host:"http://weasley.teamspace.ad:8080",videos:"/videos",videoById:"/videos/<%=id%>",trash:"/videos?filter=trashed"};o.prototype.setToken=function(e){if(!e||"string"!=typeof e)throw new Error("IngestAPI requires an authentication token passed as a string.");this.token=e},o.prototype.getToken=function(){if(!this.token)throw new Error("IngestAPI requires a token to be set.");return this.token},o.prototype.getVideos=function(e){return new r({url:s.host+s.videos,token:this.getToken(),headers:e})},o.prototype.getVideoById=function(e){return e&&"string"==typeof e?new r({url:this.parseId(s.host+s.videoById,e),token:this.getToken()}):this.promisify(!1,"IngestAPI getVideoById requires a valid videoId as a string.")},o.prototype.addVideo=function(e){if(!e||"object"!=typeof e)return this.promisify(!1,"IngestAPI addVideo requires a video object.");try{e=JSON.stringify(e)}catch(t){return this.promisify(!1,"IngestAPI addVideo failed to parse videoObject to JSON. "+t.stack)}return new r({url:s.host+s.videos,token:this.getToken(),method:"POST",data:e})},o.prototype.deleteVideo=function(e){return e&&"string"==typeof e?new r({url:this.parseId(s.host+s.videoById,e),token:this.getToken(),method:"DELETE"}):this.promisify(!1,"IngestAPI deleteVideo requires a video ID passed as a string.")},o.prototype.getVideosCount=function(){return new r({url:s.host+s.videos,token:this.getToken(),method:"HEAD"}).then(this.getVideosCountResponse.bind(this))},o.prototype.getTrashedVideosCount=function(){return new r({url:s.host+s.trash,token:this.getToken(),method:"HEAD"}).then(this.getTrashedVideosCountResponse.bind(this))},o.prototype.getVideosCountResponse=function(e){return parseInt(e.headers("Resource-Count"),10)},o.prototype.getTrashedVideosCountResponse=function(e){return parseInt(e.headers("Resource-Count"),10)},o.prototype.parseId=function(e,t){var n=e.replace("<%=id%>",t);return n},o.prototype.promisify=function(e,t){var n=i();return n(e,[t]),n},e.exports=o},function(e,t,n){var o=n(3),r=n(7),i=[200,201,202,204],s=function(e){return this.defaults={async:!0,method:"GET"},this.promise=o(),this.request=new XMLHttpRequest,this.setupListeners(),this.options=r(!0,this.defaults,e),this.options.url?(this.makeRequest(),this.promise):this.promise(!1,["Request Error : a url is required to make the request."])};s.prototype.setupListeners=function(){this.request.addEventListener("readystatechange",this.readyStateChange.bind(this))},s.prototype.makeRequest=function(){this.request.open(this.options.method,this.options.url,this.options.async),this.options.headers&&this.applyRequestHeaders(this.options.headers),this.options.token&&this.request.setRequestHeader("Authorization",this.options.token),this.options.data?(this.request.setRequestHeader("Content-type","application/json; charset=utf-8"),this.request.send(this.options.data)):this.request.send()},s.prototype.applyRequestHeaders=function(e){for(key in e)e.hasOwnProperty(key)&&this.request.setRequestHeader(key,e[key])},s.prototype.requestComplete=function(e){this.response=this.processResponse(e),this.promise(!this.response.error,[this.response])},s.prototype.processResponse=function(e){var t=this.request.getResponseHeader("Content-type"),n=e;if("application/json; charset=utf-8"===t)try{n=JSON.parse(e)}catch(o){n={error:"JSON parsing failed. "+o.stack}}return{data:n,headers:this.request.getResponseHeader.bind(this.request),statusCode:this.request.status}},s.prototype.requestError=function(e){this.promise(!1,[e])},s.prototype.readyStateChange=function(){4===this.request.readyState&&(this.isValidResponseCode(this.request.status)?this.requestComplete(this.request.responseText):this.requestError("Invalid response code."))},s.prototype.isValidResponseCode=function(e){var t,n=!1,o=i.length;for(t=0;o>t;t++)if(e===i[t]){n=!0;break}return n},e.exports=s},function(e,t,n){(function(e,t,n){!function(e){function o(e){return"function"==typeof e}function r(e){return"object"==typeof e}function i(e){"undefined"!=typeof t?t(e):"undefined"!=typeof n&&n.nextTick?n.nextTick(e):setTimeout(e,0)}var s;e[0][e[1]]=function u(e){var t,n=[],a=[],p=function(e,o){return null==t&&null!=e&&(t=e,n=o,a.length&&i(function(){for(var e=0;e<a.length;e++)a[e]()})),t};return p.then=function(p,c){var d=u(e),f=function(){function e(t){var n,i=0;try{if(t&&(r(t)||o(t))&&o(n=t.then)){if(t===d)throw new TypeError;n.call(t,function(){i++||e.apply(s,arguments)},function(e){i++||d(!1,[e])})}else d(!0,arguments)}catch(u){i++||d(!1,[u])}}try{var i=t?p:c;o(i)?e(i.apply(s,n||[])):d(t,n)}catch(u){d(!1,[u])}};return null!=t?i(f):a.push(f),d},e&&(p=e(p)),p}}([e,"exports"])}).call(t,n(4)(e),n(5).setImmediate,n(6))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t,n){(function(e,o){function r(e,t){this._id=e,this._clearFn=t}var i=n(6).nextTick,s=Function.prototype.apply,u=Array.prototype.slice,a={},p=0;t.setTimeout=function(){return new r(s.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new r(s.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},t.setImmediate="function"==typeof e?e:function(e){var n=p++,o=arguments.length<2?!1:u.call(arguments,1);return a[n]=!0,i(function(){a[n]&&(o?e.apply(null,o):e.call(null),t.clearImmediate(n))}),n},t.clearImmediate="function"==typeof o?o:function(e){delete a[e]}}).call(t,n(5).setImmediate,n(5).clearImmediate)},function(e,t){function n(){p=!1,s.length?a=s.concat(a):c=-1,a.length&&o()}function o(){if(!p){var e=setTimeout(n);p=!0;for(var t=a.length;t;){for(s=a,a=[];++c<t;)s&&s[c].run();c=-1,t=a.length}s=null,p=!1,clearTimeout(e)}}function r(e,t){this.fun=e,this.array=t}function i(){}var s,u=e.exports={},a=[],p=!1,c=-1;u.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];a.push(new r(e,t)),1!==a.length||p||setTimeout(o,0)},r.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=i,u.addListener=i,u.once=i,u.off=i,u.removeListener=i,u.removeAllListeners=i,u.emit=i,u.binding=function(e){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(e){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},function(e,t){"use strict";var n=Object.prototype.hasOwnProperty,o=Object.prototype.toString,r=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===o.call(e)},i=function(e){if(!e||"[object Object]"!==o.call(e))return!1;var t=n.call(e,"constructor"),r=e.constructor&&e.constructor.prototype&&n.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!t&&!r)return!1;var i;for(i in e);return"undefined"==typeof i||n.call(e,i)};e.exports=function s(){var e,t,n,o,u,a,p=arguments[0],c=1,d=arguments.length,f=!1;for("boolean"==typeof p?(f=p,p=arguments[1]||{},c=2):("object"!=typeof p&&"function"!=typeof p||null==p)&&(p={});d>c;++c)if(e=arguments[c],null!=e)for(t in e)n=p[t],o=e[t],p!==o&&(f&&o&&(i(o)||(u=r(o)))?(u?(u=!1,a=n&&r(n)?n:[]):a=n&&i(n)?n:{},p[t]=s(f,a,o)):"undefined"!=typeof o&&(p[t]=o));return p}}])});
//# sourceMappingURL=ingest.js.map
<!DOCTYPE html/>
<html>
    <head>
        <title>IngestAPI Test Coverage</title>
        <script src="authToken.js"></script>
        <script src="./dist/ingest.js"></script>

    </head>
    <body>
      <h1>IngestAPI</h1>

      <h2>Test Coverage</h2>
      <ul>
        <li>
          <a href="dist/integration-coverage/index.html">Javascript Integration Test Coverage</a>
        </li>
      </ul>

      <h2>Upload test</h2>
      <input class="file-picker" type="file" name="file" />
      <input class="btn-submit" type="submit" value="upload" />

      <script>
        var ingest = new IngestAPI({
          host: 'http://local.weasley.teamspace.ad:8080'
        });

        ingest.setToken('Bearer ' + window.token);

        var filePicker = document.getElementsByClassName('file-picker')[0];
        var submitbtn =  document.getElementsByClassName('btn-submit')[0];

        var upload;

        submitbtn.addEventListener('click', function () {

          var file = filePicker.files[0];

          upload = ingest.upload(file);

          upload.progress(function (percent) {
            console.log('Progress : ', percent);
          });

          // Start the upload of the file.
          upload.save().then(function (response) {
            console.log('Upload Complete : ', response);
          }, function (error) {
            console.log('Error during upload : ', error.stack);
          });

        });

      </script>
    </body>
<html>
